- 什么是ACID？
  - A，Atomicity原子性
  - C，Consistency一致性
  - I，Isolation隔离性
  - D，Durability持久性



- MySQL有哪几种事务等级？默认是哪种？
  - 读未提交，可以读到其它SQL未提交的事务的数据，造成脏读
  - 读已提交，可以读到其它SQL已经提交事务的数据，导致前后事务中多次读取的结果不一致，导致不可重复读
  - 可重复读，默认，在一次事务中前后读取的数据结果一致，但数据量相关的统计可能不一致，导致幻读
  - 串行，表锁



- CHAR 和VARCHAR 的区别？

  - char，为固定长度，范围在1~255间，如果数据不满足则填充空格
  - varchar，为可变长度，范围在1~65535

  

- BLOB 和TEXT 有什么区别？

  blob可以存储二进制数据，text则只能存普通的字符串，blob在排序和比较时区分大小写，text不区分



- 在 Mysql 中 ENUM 的用法是什么？

  枚举值，存字符串数据，可以在创建表时指定，某列只能存哪些枚举值



- 区分 CHAR_LENGTH 和 LENGTH？

  char_length统计的是字符长度，length统计的是字节数



- 如何在 Unix 和 Mysql 时间戳之间进行转换？

  使用unix_timestamp转换成毫秒值时间戳，from_unixtime转换成日期时间戳



- 如何为字段选择合适得数据类型？

  能用整形就不要用date类型，能用char就不要用varchar，能用varchar就不要用blob和text



- 列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？

  拒绝写请求并报错，可以使用alter table table_name auto_increment=1，进行重置
  
  

- MySQL有哪几种锁？

  MySQL默认的存储引擎InnoDB支持行锁和表锁，默认为行锁。

  - 乐观锁，根据版本号或者更新时间进行CAS
  - 悲观锁
    - 属性锁
      - 表锁，MyISAM在查询时，会自动加上表锁。InnoDB在开启串行也会加上表锁。
      - 行锁
        - 记录锁，id=xx，会给该id加上锁
        - 间隙锁，在可重复读、命中非唯一索引的情况下，锁住一整个区间，包括可能往区间写入的数据
        - 临键锁，特殊的间隙锁，每个非唯一索引都存在一个左开右闭的区间
    - 范围锁
      - 共享锁，读锁，select x from x **lock in share mode**
      - 排它锁，写锁，select x from x **for update**

​	

- 什么情况下会发生死锁？

  两个事务互相持有了对方需要的行记录



- MySQL有哪些存储引擎？

  MyISAM、InnoDB、RocksDB、Memory



- InnoDB 和MyISAM 有什么区别？
  - InnoDB为聚簇索引，MyISAM为非聚簇索引
  - InnoDB支持事务，MyISAM不支持
  - InnoDB支持行锁，MyISAM只支持表锁



- 聚簇索引和非聚簇索引有什么区别？

  - 聚簇索引，主键和数据存放在一起，形成一颗B+树
  - 非聚簇索引，则只有索引键

  

- 索引，主键，唯一索引，联合索引有什么区别？

  - 索引是比较笼统的概念，主键、唯一索引和联合索引都是索引
  - 唯一索引，索引具有唯一性
  - 联合索引，索引由多个列组成
  - 主键必须是唯一索引，设置多个列的情况下也可以是联合索引

  

- 什么是覆盖索引？什么是回表？
  - 当查询的字段，在索引树上时，则可以直接返回，称之为覆盖索引
  - 当查询的字段不在索引树上，需要去主键索引树上再找一次，则称之为回表



- 索引的底层实现原理？

  不管是InnoDB还是MyISAM，都是使用的B+树实现。B+树的特点是叶子节点含有多份索引数据，并且叶子节点之间存在指针，形成双向链表。
  
  

- B树和B+树有什么区别？为什么不用B树？

  B树对排序的支持较差，并且数据量大时，树会比较高，磁盘索引的开销较大。B+树的非叶子节点不存储数据，而是存储一批索引，树就比较矮。在叶子节点直接，还存储了前后的指针，形成双端联表，对排序的支持也更好。

  

- 什么是叶裂，如何优化索引？

  B+树增删数据频繁，导致叶子节点不断重建和均衡，称为叶裂。
  
  应尽量写入单调递增的数据，使新增的数据在最右方不断生成新叶子，避免原有叶子节点发生均衡。删除数据尽量使用逻辑删除，避免物理删除形成磁盘空洞。



- 在哪些场景下索引会失效？

  失效有两个含义，一使未走索引，二是走了索引，但仍然发生了全表扫描。

  - 未走索引失效，使用前模糊匹配
  - 走了索引也失效，联合索引越过了前面的字段，如a,b形成索引，直接根据b查

  

- 可以使用多少列创建索引？

  最多可以创建16个索引列



- NOW()和CURRENT_DATE()有什么区别？

  now()等价于current_timestamp()，显示当前的完整时间戳

  current_date()显示当前时间戳的日期，需要加上current_time()才是等于now()



- 有哪些通用 SQL 函数？

  - concat()，连接两个字符，合成一个输出，通常用于字段合并
  - format()，精度计算，如保留小数点等
  - current_date()，current_time()，current_timestamp()，now()，获取当前的时间
  - datediff()，对日期进行减法，得到整型天数
  - subtime()，对时间进行减法操作，得到的类型还是时间

  

- 什么是笛卡尔积？外连接、内连接、自连接的区别是什么？

  - 笛卡尔积，两个集合得乘积
  - 外连接
    - 左连接，查询左表的数据，或者查询左表不包含右表的数据
    - 右连接，查询右表的数据，或者查询右表不好含左表的数据
    - 全连接，查询两张表的数据，对符合条件的数据，仅保留一份

  - 内连接，仅保留两张表符合条件的数据
  - 自连接，使用where进行条件判断



- join和inner join有什么区别？

  join默认就是inner join，没有区别

  

- Heap 表是什么？

  Memory存储引擎提供的内存表，数据存储在内存中，不允许存放blob和text数据，不支持自增。



- 与 Oracle 相比，Mysql 有什么优势？

  开源，可以二次开发，免费使用



- MySQL有哪几种日志？分别有什么作用？

  - binlog，存储行数据的二进制数据，用以主从同步时，控制数据的一致性。

    也有基于该特性实现的数据迁移、数据备份、流数据读取等。

  - redolog，用以实现宕机时，事务的回滚和恢复

  - undo log，记录数据库数据版本对应的快照，用以实现多版本并发控制



- redo log的写入流程是怎样的？

  先将数据写入到redo log buffer中，然后再通过刷新策略，写入到redo log日志中。刷新策略有三种，可以定时刷新，性能最高；事务提交时刷新，默认的配置；也可以交由操作系统控制，但操作系统落库时间不可知。



- MySQL发生宕机，事务的恢复流程是怎样的？

  先读取redo log的日志，进行重放，找出处于prepare状态的事务，比对bin log日志是否缺失，如果数据完整，则将redo log中事务的状态设置为commit，如果缺失，则根据XID找到undo log对应的版本，进行回退。

  redo log可以保证单机的数据不丢失，之所以比对bin log是为了防止主从数据出现不一致。

